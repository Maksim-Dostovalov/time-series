---
title: "Тесты единичного корня. Расширенный тест Дики-Фуллера"
author: "Достовалов М.Ю."
date: "07.03.2024"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document:
    df_print: paged
lang: "ru-russian"
editor_options:
  markdown:
    wrap: 72
---

Установим необходимые пакеты и подгрузим библиотеки

```{r message=FALSE, warning=FALSE}
# install.packages('urca')
# install.packages('aTSA')

library(aTSA)
library(urca)
library(haven)
library(stats)
library(tseries)
```

Задание 1. Даны случайные процессы у1, у2, у3, y4, у21. Файл: DF.dta.
Cформулируйте и проверьте гипотезу о наличие единичного корня. Запишите
тестируемую регрессию в критерии Дики-Фуллера для y1 .

Загрузим данные из файла

```{r}
#file.choose()
DF=read_dta("DF.dta") # укажите свой путь, где лежит файл
```

1.  Построим графики исходного временного ряда для процесса y1

```{r}
plot.ts(DF$y1, xlab="t")
```

Проведем тест Дики-Фуллера (с константой) для у1

```{r}
summary(ur.df(DF$y1, type = c("drift"), lags = 0))
```

Проведем тест Дики-Фуллера (с константой и с трендом) для у1

```{r}
summary(ur.df(DF$y1, type = c("trend"), lags = 0))
```

Проведем расширенный тест Дики-Фуллера (с 1 дополнительным лагом) для у1

```{r}
summary(ur.df(DF$y1, type = c("drift"), lags = 1))
```

Проведем расширенный тест Дики-Фуллера (с 2 дополнительными лагами) для
у1

```{r}
summary(ur.df(DF$y1, type = c("drift"), lags = 2))
```

Проведем тест Дики-Фуллера (с оптимальным количеством лагов) для у1

```{r}
summary(ur.df(DF$y1, type = c("drift")))
```

Задание 2. Разностно-стационарные ряды. Исследуйте y2 и y21. Используйте
тест Дики-Фуллера для первой разности изучаемых процессов (в случае
необходимости). Сделайте вывод о порядке интегрируемости процессов
(после какой разности процесс стал стационарным).

Построим графики исходного временного ряда для процесса y2

```{r}
plot.ts(DF$y2, xlab="t")
```

Проведем тест Дики-Фуллера (с константой и с трендом) для у2

```{r}
summary(ur.df(DF$y2, type = c("trend")))
```

Проведем тест Дики-Фуллера (с константой и без тренда) для у2

```{r}
summary(ur.df(DF$y2, type = c("drift")))
```

Проведем тест Дики-Фуллера (без константы и тренда) для у2

```{r}
summary(ur.df(DF$y2, type = c("none")))
```

Проведем тест Дики-Фуллера (с константой и трендом) для первой разности
у2

```{r}
d_y2 = diff(DF$y2)
summary(ur.df(d_y2, type = c("trend")))
```

Вывод: После взятия первой разности процес у2 стал стационарным. Значит
это разностно-стационарный процесс с порядком интегрируемости I(1)

Построим графики исходного временного ряда для процесса y21

```{r}
plot.ts(DF$y21, xlab="t")
```

Проведем тест Дики-Фуллера (с константой и с трендом) для у21

```{r}
summary(ur.df(DF$y21, type = c("trend")))
```

Проведем тест Дики-Фуллера (с константой и без тренда) для у21

```{r}
summary(ur.df(DF$y21, type = c("drift")))
```

Проведем тест Дики-Фуллера (без константы и тренда) для у21

```{r}
summary(ur.df(DF$y21, type = c("none")))
```

Проведем тест Дики-Фуллера (с константой и трендом) для первой разности
у21

```{r}
d_y21 = diff(DF$y21)
summary(ur.df(d_y21, type = c("trend")))
```

Проведем тест Дики-Фуллера (с константой и трендом) для второй разности
у21

```{r}
d2_y21 = diff(d_y21)
summary(ur.df(d2_y21, type = c("trend")))
```

Вывод: После взятия второй разности процес у2 стал стационарным. Значит
это разностно-стационарный процесс с порядком интегрируемости I(2)

Задание 3. Тренд-стационарный ряд. Исследуйте y3. Предположив наличие в
процессах детерминированного тренда, проведите тест Дики-Фуллера.
Сделайте вывод.

Построим графики исходного временного ряда для процесса y3

```{r}
plot.ts(DF$y3, xlab="t")
```

Проведем тест Дики-Фуллера (с константой и без тренда) для у3

```{r}
summary(ur.df(DF$y3, type = c("drift")))
```

Проведем тест Дики-Фуллера (c константой и трендом) для у3

```{r}
summary(ur.df(DF$y3, type = c("trend")))
```

Вывод: Так как после добавления в модель тренда процесс стал
стационарным, то это тренд-стационарный процесс.

Задание 4. Альтернативные тесты единичного корня. Проведите PP- и
KPSS-тесты для y1, сравните результаты.

Проведем тест Дики-Фуллера для у1

```{r}
adf.test(DF$y1)
#stationary.test(DF$y1, method = "adf")
```

Проведем PP-тест Филлипса-Перрона для у1

```{r}
pp.test(DF$y1)
stationary.test(DF$y1, method = "pp")
```

Проведем тест KPSS (Квятковского-Филлипса-Шмидта-Шина) для у1

```{r}
kpss.test(DF$y1)
#stationary.test(DF$y1, method = "kpss")
```

Задание 5. Тесты единичного корня с учетом структурного сдвига.
Проведите тесты единичного корня для у4, в предположении наличия
структурного сдвига. Сделайте выводы.

Построим графики исходного временного ряда для процесса y4

```{r}
plot.ts(DF$y4, xlab="t")
```

Проведем тест Эндрюса-Зивота для у4 с учетом структурного сдвига 1-го
типа (на константу)

```{r}
summary(ur.za(DF$y4, model = c("intercept")))
```

Проведем тест Эндрюса-Зивота для у4 с учетом структурного сдвига 2-го
типа (на наклон)

```{r}
summary(ur.za(DF$y4, model = c("trend")))
```

Проведем тест Эндрюса-Зивота для у4 с учетом структурного сдвига 3-го
типа (на константу и наклон)

```{r}
summary(ur.za(DF$y4, model = c("both")))
```
