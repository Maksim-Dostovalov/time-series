---
title: "Семинар 2. Автокорреляционные функции процессов"
author: "Достовалов М.Ю."
date: "25.01.2024"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document:
    df_print: paged
lang: "ru-russian"
---

2.  Автокорреляционные функции ACF/PACF процессов.

Подгрузим необходимые библиотеки для работы

```{r message=FALSE, warning=FALSE}
library(haven)
```

Загрузим данные из файла

```{r}
#file.choose()
S2=read_dta("S2.dta") # укажите свой путь, где лежит файл
```

Задание 1. Для белого шума вычислите в R значения автокорреляции 1-го, 2-го, 3-го и 4-го порядка и постройте карролелограмму

ACF для белого шума

```{r}
acf(S2$wn, lag.max=4, plot=FALSE)
```

График ACF для белого шума

```{r}
acf(S2$wn, 10, main="Белый шум", ylab="ACF(wn)")
```

PACF для белого шума

```{r}
pacf(S2$wn, lag.max=4, plot=FALSE)
```

График PACF для белого шума

```{r}
pacf(S2$wn, 10, main="Белый шум", ylab="PACF(wn)")
```

Задание 2. Проведите тест Льюинга-Бокса на наличие автокорреляции. В дальнейшем будет использоваться для анализа остатков.

Проверим нулевую гипотезу Н0: ρ1=…= ρk=0 («автокорреляция до лага k отсутствует»)

```{r}
Box.test(S2$wn, lag=10) # Тест Бокса-Пирса
Box.test(S2$wn,lag=10, type="Ljung") # Тест Льюинга-Бокса дает более качественные результаты, т.к. ближе к ХИ^2-распределению
```

Задание 3. Вычислите ACF и PACF для всех процессов, используя встроенные процедуры. Как ведут себя графики ACF и PACF для рассмотренных выше стационарных и нестационарных процессов? Сделайте вывод.

ACF/PACF для линейного тренда

```{r}
acf(S2$tr1, 10, main="Линейный тренд", ylab="ACF(tr1)")
pacf(S2$tr1, 10, main="Линейный тренд", ylab="PACF(tr1)")
```

ACF/PACF для параболического тренда

```{r}
acf(S2$tr2, 10, main="Параболический тренд", ylab="ACF(tr2)")
pacf(S2$tr2, 10, main="Параболический тренд", ylab="PACF(tr2)")
```

ACF/PACF для случайного блуждания

```{r}
acf(S2$rw, 10, main="Случайное блуждание", ylab="ACF(rw)")
pacf(S2$rw, 10, main="Случайное блуждание", ylab="PACF(rw)")
```

ACF/PACF для случайный процесс с периодической составляющей Yt =3cos(2πt/20)+ εt

```{r}
acf(S2$cos, 25, main="Периодический процесс", ylab="ACF(cos)")
pacf(S2$cos, 25, main="Периодический процесс", ylab="PACF(cos)")
```